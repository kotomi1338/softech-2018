---
layout: post
title:  "06 Rubygems入門"
date:   2017-06-25 12:00:00 +0900

---

## 自分用メモ

- after setup for gems: nokogiriのインストール
- 雑談ネタ
    * とっしー
    * 土居先生誤爆怒られ事件について

## はじめに

先週までの講義で、Rubyの基礎とオブジェクト指向の基本を学んできました。今回からは、いよいよgemを使った実践的なプログラムを書いていきましょう。

## Gemについて

ある程度の規模をプログラムを書くときは、ゼロからすべて自分で書くよりも、ライブラリというものを使うことのほうが多いです。ライブラリとは、一言で言うと「よくある機能をひとまとめにして再利用可能にしたプログラムの集まり」です。

ライブラリは、自分で作ることもできるし、インターネットに公開されている便利なライブラリを利用することもできます。

例えば、学校のニュースを集めてTwitterにツイートするというプログラムを作りたい時、ゼロからすべてを自分で書こうとすると大変ですが、「Twitterにツイートする」ためのライブラリを導入して、それを使うようにすれば、自分は「学校のニュースを集める」という部分のプログラミングに集中することができます。

さて、Rubyでは、ほとんどのライブラリは "gem" という形式で公開されています。多くのgemは、[RubyGems.org](https://rubygems.org)というWebサイト上で配信されています。直接Webサイトを閲覧したり、gemというコマンドを利用してgemを探したり、インストールしたりすることができます。

実際に、gemをインストールして使ってみたいのですが、その前に設定が必要です。

## 環境設定

### プロキシの設定

gemコマンドは、インターネットからgemをダウンロードします。苫小牧高専の学内ネットワークからインターネットを利用するには、まずプロキシに設定が必要です。

Windowsのエクスプローラからjocalc1に移動し、 .bashrc というファイルを開くか、新規作成して、ファイルの最後に以下の2行を追加してください。

```
export http_proxy=http://user_name:password@172.23.1.8:8080
export https_proxy=$http_proxy
```

なお、user_nameとpasswordの部分は、自分のCAI室（またはBlackboard）のアカウントのユーザ名とパスワードに読み替えてください。


### .gemrcの設定

次に、.gemrcというgemの設定ファイルを記述します。

Windowsのエクスプローラからjocalc1に移動し、.gemrcというファイルを開くか新規作成して、ファイルの最後に以下の1行を追加してください。

```
gem: --user-install
```

これにより、gemがシステム領域ではなくユーザ領域にインストールされるようになります。


### gemをインストールしてみる

いよいよ、最初のgemをインストールしてみましょう。

今回はお試しとして、日本人の名前や日本の住所を適当に組み合わせて出力してくれる、gimeiというgemをインストールしてみましょう。

Tera Termを開いてjocalc1にログインし、以下のコマンドを実行してください。  
（先頭の$マークはプロンプトなので無視してください。）

```
$ gem install gimei
```

インストールが完了すると、gimei gemを使えるようになります。irbを起動して、早速gimei gemを使ってみましょう。

{% highlight ruby linenos %}
require 'gimei'

gimei = Gimei.new
gimei.class
#=> Gimei
# gimei変数はGimeiクラスのオブジェクトです。

gimei.name.kanji
#=> "石塚 叶絵"
gimei.name.hiragana
#=> "いしづか かなえ"
gimei.address.kanji
#=> "佐賀県広島市西区駅前"
{% endhighlight %}

このように、gimei gemを使うと、"それっぽい"日本人の名前や住所を生成することができます。アプリを作っていて、サンプルのユーザが欲しい時に便利ですね。

今回利用した機能以外にも、いくつかの機能があります。詳しくは、以下のページを参照してみてください。

[willnet/gimei: random Japanese name and address generator](https://github.com/willnet/gimei)


## gemのインストールと使い方

gimei gemを通じて、gemのインストールと基本的な使い方を体験してみました。改めてまとめると、gemを利用したプログラミングの流れは、以下の通りになります。

1. やりたい事に応じてgemを探す
2. gem install ○○でインストール
3. 使い方を調べる
4. irbやRubyのコードで require ○○
5. 使う

gemはインストールするだけではダメで、プログラムの最初に require '○○' と宣言しなければなりません。C言語でいう、include文のようなものです。

多くのgemには、gemの配布用サイトとは別に使い方のページが用意されているので、それを参照しながら使ってみるのが基本です。

今後は、私達のプログラミングをサポートする様々なgemを使って、実践的なプログラムを作っていきましょう。

